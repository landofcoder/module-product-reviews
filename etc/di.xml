<?xml version="1.0"?>
<!--
  * Hgati
  *
  * NOTICE OF LICENSE
  *
  * This source file is subject to the Hgati.com license that is
  * available through the world-wide-web at this URL:
  * https://hgati.com/terms
  *
  * DISCLAIMER
  *
  * Do not edit or add to this file if you wish to upgrade this extension to newer
  * version in the future.
  *
  * @category   Hgati
  * @package    Hgati_ProductReviews
  * @copyright  Copyright (c) 2021 Hgati (https://www.hgati.com/)
  * @license    https://hgati.com/terms
  -->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <!--frontend override-->
    <preference for="Magento\Review\Block\Form" type="Hgati\ProductReviews\Block\Form" />
    <preference for="Magento\Review\Block\Product\View\ListView" type="Hgati\ProductReviews\Block\Product\View\ListView" />
    <!--End frontend override-->

    <!-- Api Repository -->
    <preference for="Hgati\ProductReviews\Api\GalleryRepositoryInterface" type="Hgati\ProductReviews\Model\GalleryRepository" />
    <preference for="Hgati\ProductReviews\Api\GetProductReviewsInterface" type="Hgati\ProductReviews\Model\GetProductReviews"/>
    <preference for="Hgati\ProductReviews\Api\ReviewRepositoryInterface" type="Hgati\ProductReviews\Model\ReviewRepository"/>
    <preference for="Hgati\ProductReviews\Api\PostProductReviewsInterface" type="Hgati\ProductReviews\Model\PostProductReviews"/>
    <preference for="Hgati\ProductReviews\Api\LikeRepositoryInterface" type="Hgati\ProductReviews\Model\LikeRepository"/>
    <preference for="Hgati\ProductReviews\Api\UnLikeRepositoryInterface" type="Hgati\ProductReviews\Model\UnLikeRepository"/>
    <preference for="Hgati\ProductReviews\Api\ReportRepositoryInterface" type="Hgati\ProductReviews\Model\ReportRepository"/>
    <preference for="Hgati\ProductReviews\Api\VerifyRepositoryInterface" type="Hgati\ProductReviews\Model\VerifyRepository"/>
    <preference for="Hgati\ProductReviews\Api\CustomizeRepositoryInterface" type="Hgati\ProductReviews\Model\CustomizeRepository"/>
    <preference for="Hgati\ProductReviews\Api\RemindersRepositoryInterface" type="Hgati\ProductReviews\Model\RemindersRepository"/>
    <preference for="Hgati\ProductReviews\Api\ReportHistoryRepositoryInterface" type="Hgati\ProductReviews\Model\ReportHistoryRepository"/>
    <preference for="Hgati\ProductReviews\Api\RatingRepositoryInterface" type="Hgati\ProductReviews\Model\RatingRepository" />

    <!-- API Data -->
    <preference for="Hgati\ProductReviews\Api\Data\GallerySearchResultsInterface" type="Magento\Framework\Api\SearchResults"/>
    <preference for="Hgati\ProductReviews\Api\Data\VerifyInterface" type="Hgati\ProductReviews\Model\Data\Verify"/>
    <preference for="Hgati\ProductReviews\Api\Data\GalleryInterface" type="Hgati\ProductReviews\Model\Gallery"/>
    <preference for="Hgati\ProductReviews\Api\Data\CustomizeInterface" type="Hgati\ProductReviews\Model\CustomReview"/>
    <preference for="Hgati\ProductReviews\Api\Data\ReviewInterface" type="Hgati\ProductReviews\Model\Data\Review"/>
    <preference for="Hgati\ProductReviews\Api\Data\ReplyInterface" type="Hgati\ProductReviews\Model\ReviewReply"/>
    <preference for="Hgati\ProductReviews\Api\Data\RatingVoteInterface" type="Hgati\ProductReviews\Model\Data\RatingVote"/>
    <preference for="Hgati\ProductReviews\Api\Data\DetailedSummaryInterface" type="Hgati\ProductReviews\Model\Data\DetailedSummary"/>
    <preference for="Hgati\ProductReviews\Api\Data\ReviewDataInterface" type="Hgati\ProductReviews\Model\Data\ReviewData"/>
    <preference for="Hgati\ProductReviews\Api\Data\ImageInterface" type="Hgati\ProductReviews\Model\Data\Image"/>
    <preference for="Hgati\ProductReviews\Api\Data\CustomizeInterface" type="Hgati\ProductReviews\Model\CustomReview"/>
	<preference for="Hgati\ProductReviews\Api\Data\CustomizeSearchResultsInterface" type="Magento\Framework\Api\SearchResults"/>
	<preference for="Hgati\ProductReviews\Api\Data\RemindersInterface" type="Hgati\ProductReviews\Model\Reminders"/>
	<preference for="Hgati\ProductReviews\Api\Data\RemindersSearchResultsInterface" type="Magento\Framework\Api\SearchResults"/>
	<preference for="Hgati\ProductReviews\Api\Data\ReportHistoryInterface" type="Hgati\ProductReviews\Model\RateReport"/>
	<preference for="Hgati\ProductReviews\Api\Data\ReportHistorySearchResultsInterface" type="Magento\Framework\Api\SearchResults"/>
    <preference for="Hgati\ProductReviews\Api\Data\ReplySearchResultInterface" type="Hgati\ProductReviews\Model\ReplySearchResult"/>
    <preference for="Hgati\ProductReviews\Api\Data\ReviewSearchResultInterface" type="Hgati\ProductReviews\Model\ReviewSearchResult"/>

    <type name="Magento\Framework\Model\Entity\RepositoryFactory">
        <arguments>
            <argument name="entities" xsi:type="array">
                <item name="Hgati\ProductReviews\Api\Data\GalleryInterface" xsi:type="string">Hgati\ProductReviews\Api\GalleryRepositoryInterface</item>
            </argument>
        </arguments>
    </type>

    <type name="Magento\Framework\Console\CommandList">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="hgatireview_index_review_summary" xsi:type="object">Hgati\ProductReviews\Console\Command\IndexReviewSummary</item>
            </argument>
        </arguments>
    </type>

    <virtualType name="Hgati\ProductReviews\Model\Api\SearchCriteria\CollectionProcessor\GalleryFilterProcessor" type="Magento\Framework\Api\SearchCriteria\CollectionProcessor\FilterProcessor">
        <arguments>
            <argument name="customFilters" xsi:type="array">
                <item name="store_id" xsi:type="object">Hgati\ProductReviews\Model\Api\SearchCriteria\CollectionProcessor\FilterProcessor\GalleryStoreFilter</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hgati\ProductReviews\Model\Api\SearchCriteria\GalleryCollectionProcessor" type="Magento\Framework\Api\SearchCriteria\CollectionProcessor">
        <arguments>
            <argument name="processors" xsi:type="array">
                <item name="filters" xsi:type="object">Hgati\ProductReviews\Model\Api\SearchCriteria\CollectionProcessor\GalleryFilterProcessor</item>
                <item name="sorting" xsi:type="object">Magento\Framework\Api\SearchCriteria\CollectionProcessor\SortingProcessor</item>
                <item name="pagination" xsi:type="object">Magento\Framework\Api\SearchCriteria\CollectionProcessor\PaginationProcessor</item>
            </argument>
        </arguments>
    </virtualType>

    <type name="Magento\Review\Block\Adminhtml\Add\Form">
       <plugin name="review_add_form_custom" type="Hgati\ProductReviews\Plugin\Adminhtml\Add\Form" />
    </type>
    <type name="Magento\Review\Block\Adminhtml\Edit\Form">
       <plugin name="review_edit_form_custom" type="Hgati\ProductReviews\Plugin\Adminhtml\Edit\Form" />
    </type>
    <type name="Magento\Review\Controller\Adminhtml\Product\Post">
        <plugin name="save_review_custom" type="Hgati\ProductReviews\Plugin\Adminhtml\Post" />
    </type>
    <type name="Magento\Review\Controller\Adminhtml\Product\Save">
       <plugin name="save_review_custom" type="Hgati\ProductReviews\Plugin\Adminhtml\Save" />
    </type>
    <type name="Magento\Customer\Controller\Account\EditPost">
        <plugin name="update_customer_to_reminder" type="Hgati\ProductReviews\Plugin\Frontend\Customer\EditPost" />
    </type>

    <type name="Magento\Framework\View\Element\UiComponent\DataProvider\CollectionFactory">
        <arguments>
            <argument name="collections" xsi:type="array">
                <item name="hgati_product_reviews_gallery_listing_data_source" xsi:type="string">Hgati\ProductReviews\Model\ResourceModel\Gallery\Grid\Collection</item>
                <item name="hgati_product_reviews_reminders_listing_data_source" xsi:type="string">Hgati\ProductReviews\Model\ResourceModel\Reminders\Grid\Collection</item>
                <item name="hgati_product_reviews_replies_listing_data_source" xsi:type="string">Hgati\ProductReviews\Model\ResourceModel\ReviewReply\Grid\Collection</item>
            </argument>
        </arguments>
    </type>
    <type name="Hgati\ProductReviews\Model\ResourceModel\Gallery\Grid\Collection">
        <arguments>
            <argument name="mainTable" xsi:type="string">hgati_product_reviews_gallery</argument>
            <argument name="eventPrefix" xsi:type="string">hgati_product_reviews_gallery_grid_collection</argument>
            <argument name="eventObject" xsi:type="string">hgati_product_reviews_gallery_grid_collection</argument>
            <argument name="resourceModel" xsi:type="string">Hgati\ProductReviews\Model\ResourceModel\Gallery</argument>
        </arguments>
    </type>

    <type name="Hgati\ProductReviews\Model\ResourceModel\Reminders\Grid\Collection">
        <arguments>
            <argument name="mainTable" xsi:type="string">hgati_product_reviews_reminders</argument>
            <argument name="eventPrefix" xsi:type="string">hgati_product_reviews_reminders_grid_collection</argument>
            <argument name="eventObject" xsi:type="string">hgati_product_reviews_reminders_grid_collection</argument>
            <argument name="resourceModel" xsi:type="string">Hgati\ProductReviews\Model\ResourceModel\Reminders</argument>
        </arguments>
    </type>

    <type name="Hgati\ProductReviews\Model\ResourceModel\ReviewReply\Grid\Collection">
        <arguments>
            <argument name="mainTable" xsi:type="string">hgati_review_reply</argument>
            <argument name="eventPrefix" xsi:type="string">hgati_product_reviews_replies_grid_collection</argument>
            <argument name="eventObject" xsi:type="string">hgati_product_reviews_replies_grid_collection</argument>
            <argument name="resourceModel" xsi:type="string">Hgati\ProductReviews\Model\ResourceModel\ReviewReply</argument>
        </arguments>
    </type>

    <!-- Commands -->
    <preference for="Hgati\ProductReviews\Model\Review\Command\DeleteByIdInterface" type="Hgati\ProductReviews\Model\Review\Command\DeleteById"/>
    <preference for="Hgati\ProductReviews\Model\Review\Command\DeleteReplyByIdInterface" type="Hgati\ProductReviews\Model\Review\Command\DeleteReplyById"/>
    <preference for="Hgati\ProductReviews\Model\Review\Command\SaveInterface" type="Hgati\ProductReviews\Model\Review\Command\Save"/>
    <preference for="Hgati\ProductReviews\Model\Review\Command\GetInterface" type="Hgati\ProductReviews\Model\Review\Command\Get"/>
    <preference for="Hgati\ProductReviews\Model\Review\Command\GetListInterface" type="Hgati\ProductReviews\Model\Review\Command\GetList"/>
    <preference for="Hgati\ProductReviews\Model\Review\Command\ReviewReplyInterface" type="Hgati\ProductReviews\Model\Review\Command\ReviewReply"/>
    <preference for="Hgati\ProductReviews\Model\Review\Command\GetListReplyInterface" type="Hgati\ProductReviews\Model\Review\Command\GetListReply"/>
    <preference for="Hgati\ProductReviews\Model\Review\Command\SummaryRateInterface" type="Hgati\ProductReviews\Model\Review\Command\SummaryRate"/>
    <preference for="Hgati\ProductReviews\Model\Review\Command\VerifyBuyerInterface" type="Hgati\ProductReviews\Model\Review\Command\VerifyBuyer"/>
    <preference for="Hgati\ProductReviews\Model\Review\Command\GetSummaryInterface" type="Hgati\ProductReviews\Model\Review\Command\GetSummary"/>
    <preference for="Hgati\ProductReviews\Model\ReviewValidatorInterface" type="Hgati\ProductReviews\Model\ReviewValidationChain"/>

    <preference for="Hgati\ProductReviews\Model\Review\ReviewTypeResolverInterface" type="Hgati\ProductReviews\Model\Review\ReviewTypeResolver"/>

    <type name="Hgati\ProductReviews\Model\ReviewValidationChain">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="title" xsi:type="object">Hgati\ProductReviews\Model\Review\Validator\TitleValidator</item>
                <item name="detail" xsi:type="object">Hgati\ProductReviews\Model\Review\Validator\DetailValidator</item>
                <item name="nickname" xsi:type="object">Hgati\ProductReviews\Model\Review\Validator\NicknameValidator</item>
                <item name="review_entity" xsi:type="object">Hgati\ProductReviews\Model\Review\Validator\ReviewEntityValidator</item>
                <item name="entity_pk_value" xsi:type="object">Hgati\ProductReviews\Model\Review\Validator\EntityPkValueValidator</item>
                <item name="stores" xsi:type="object">Hgati\ProductReviews\Model\Review\Validator\StoresValidator</item>
            </argument>
        </arguments>
    </type>
</config>
